# vim: set fileencoding=UTF-8 :
# vim:filetype=python

import os
import process_subsidence as ps
import gis

Import('*')

env.Command(
        source=['#data/Global/delta_areas.pd',
                experiments['pristine']['Qs']],
        target='#data/Global/natural_subsidence.pd',
        action=ps.steady_state_subsidence,
        eustatic_slr=experiments['pristine']['eustatic_slr'])

env.Command(
        source='/Users/ztessler/data/Groundwater_Wada2012/gwd02000.asc',
        target='#data/Global/groundwater.tif',
        action='gdal_translate -of GTiff -a_srs "epsg:4326" $SOURCE $TARGET')

for experiment, config in experiments.iteritems():
    # accelerated compaction:
    # groundwater
    env.Command(
            source=['#data/Global/deltas.json',
                    '#data/Global/groundwater.tif'],
            target='#data/Global/delta_groundwater.1.pd',
            action=gis.delta_zonal_stats)
    env.Command(
            source='#data/Global/delta_groundwater.1.pd',
            target='#data/Global/delta_groundwater.pd',
            action=ps.clean_groundwater_stats)
    env.Command(
            source=['#data/Global/delta_groundwater.pd',
                    '#data/Global/delta_areas.pd'],
            target='#data/Global/delta_drawdown.pd',
            action=ps.compute_drawdown)
    env.Command(
            source=['#data/Global/delta_drawdown.pd',
                    '#data/Global/natural_subsidence.pd'],
            target='#data/Global/delta_groundwater_subsidence.pd',
            action=ps.groundwater_subsidence)

    # oil/gas
    env.Command(
            source=['/Users/ztessler/data/WorldPetroleumAssessment/tps_sumg/tps_sumg.shp',
                    '#data/Global/deltas.json'],
            target='#data/Global/delta_oilgas.pd',
            action=ps.oilgas_locations)
    env.Command(
            source='#data/Global/delta_oilgas.pd',
            target='#data/Global/delta_oilgas_subsidence.pd',
            action=ps.oilgas_subsidence)


    # accelerated sea-level rise




    pass

