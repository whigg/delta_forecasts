# vim: set fileencoding=UTF-8 :
# vim:filetype=python

import os
import process_sediment as ps

Import('*')

# convert rgis files to netCDF, use BQART model to estimate sed flux under
# different anthro conditions (including none), use to estimate natural
# subsidence rates based on sed flux, sediment retention ratio (see Syvitski and
# Saito 2007 for ratios) and delta surface area

for experiment, config in experiments.iteritems():
    if experiment != 'pristine':
        env.Command(
                source=[config['reservoir_rast'].format(ver='', ext='tif'),
                        config['discharge_rast'].format(ver='', ext='tif'),
                        config['basins_rast'].format(ver='', ext='tif'),
                        config['basin_ids']],
                target=config['Te'],
                action=ps.res_trapping)

        env.Command(
                source=[config['per_capita_gdp'].format(ver='', ext='pd'),
                        config['pop_dens'].format(ver='', ext='pd')],
                target=config['Eh'],
                action=ps.compute_Eh)

    env.Command(
            source=config['ice'].format(ver='', ext='pd'),
            target=config['I'],
            action=ps.compute_I)

    env.Command(
            source=[config['I'],
                    config['lithology'].format(ver='', ext='pd'),
                    config['Te'],
                    config['Eh']],
            target=config['B'],
            action=ps.compute_B)

    env.Command(
            source=[config['B'],
                    config['discharge'].format(ver='', ext='pd'),
                    config['basin_areas'],
                    config['relief'].format(ver='', ext='pd'),
                    config['airtemp'].format(ver='', ext='pd')],
            target=config['Qs'],
            action=ps.compute_Qs)
